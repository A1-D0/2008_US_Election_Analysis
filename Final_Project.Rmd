---
output:
  pdf_document: default
  html_document: default
---
---
title: "Exploration of the Influential Factor of the Election Results in 2008 Using Logistic Regression Models"
author: "Daisy, Mike, and Osvaldo"
output: pdf_document
date: "2024-12-05"
---

```{r setup, echo=FALSE}
# consider removing code from knit file
knitr::opts_chunk$set(echo = FALSE)

```

```{r, echo=FALSE, results='hide', warning=FALSE, message=FALSE}
library(Stat2Data)
library(ggplot2)
library(dplyr)
library(car)
data("Election08")
```

# Abstract
This study investigates state-level factors to predict whether Barack Obama or John McCain won the 2008 U.S. presidential election. Using both simple and multiple logistic regression models, we analyze predictors such as income, education levels, and political leaning to determine their relationship with election outcomes. Empirical logit plots are employed to verify the linearity assumption for logistic regression, ensuring the validity of the models. Our analysis identifies the most significant contributors to predicting election results and evaluates the effectiveness of the multiple logistic regression model compared to simpler models. The findings provide insights into the factors most influential in determining the outcome of the 2008 U.S. presidential election.

# Introduction
This study investigates the state-level socioeconomic and political factors that most effectively predicted the outcomes of the 2008 U.S. presidential election using the **Election08** dataset. By applying logistic regression models, we aim to explore the relationships between predictors such as per capita income, educational attainment, and political leaning and their impact on election results. This analysis seeks to identify the most influential factors driving voting behavior across the 50 states and the District of Columbia.

# Research Question
Which state-level factor—political leaning, education level, or income—is the most influential in predicting the outcome of the 2008 U.S. presidential election? Additionally, does a multiple logistic regression model provide better predictive performance compared to individual simple logistic regression models for this election?

# Expected Findings
We anticipate that political leaning, as measured by the difference between the percentage of Democrats and Republicans in each state (Dem.Rep), will be the most influential factor in determining the outcome of the 2008 U.S. presidential election. States with a higher proportion of Democrats relative to Republicans are expected to have a higher likelihood of being won by Barack Obama.
Additionally, we hypothesize that a multiple logistic regression model incorporating multiple predictors, including Income, HS, BA, and Dem.Rep, will provide the most accurate predictions of election outcomes. This is because the interaction of socioeconomic factors with political alignment likely captures more nuanced variations in voting behavior than single-variable models. The multivariable approach is expected to demonstrate the best fit and predictive power, as assessed by appropriate statistical metrics.

# Context and Relevance:
Understanding the demographic and socioeconomic factors that influence voting behavior is critical for political strategy and policy analysis. This study examines how variables such as income and education correlate with election outcomes, shedding light on patterns in state-level voting behavior. By focusing on the differences between Democratic and Republican political affiliations, this analysis highlights key dynamics in electoral decision-making.

# Research Population:
The research population consists of all 50 U.S. states and the District of Columbia, as represented in the **Election08** dataset. This includes data on state-level socioeconomic characteristics (per capita income, high school, and college education levels) and political leaning (difference in Democrat and Republican support). The population is analyzed to predict whether Barack Obama or John McCain won each state in the 2008 U.S. presidential election.

# Methodology
The dataset of reference contains information from all 50 states and the District of Columbia for the 2008 U.S. presidential election. This analysis consists of 5 models, 4 of which investigate if **Income**, **HS**, **BA**, and **Dem.Rep** are associated with the odds that Obama (Democrat) wins the state in 2008 (**ObamaWin** = 1), and 1 of which is an interaction model that investigates the joint effect of these four variables.

# Rationale: Explanation of the Modeling Process and Method Choice

The primary goal of this project is to predict state-level election outcomes for the 2008 U.S. presidential election. The dependent variable, `ObamaWin`, is categorical (1 = Obama won, 0 = McCain won), making logistic regression the most appropriate modeling technique. Logistic regression is specifically designed to model binary outcomes by estimating the probability of a success (in this case, Obama winning a state) as a function of predictor variables.

The following modeling process is used to achieve this objective:
1. Simple Logistic Regression:
   - To explore the relationship between each predictor (`Income`, `HS`, `BA`, `Dem.Rep`) and the dependent variable independently.
   - This step allows us to identify which variables are individually significant predictors of the election outcome.
2. Multiple Logistic Regression:
   - To account for the interaction and combined effect of all predictors on the election outcome.
   - This model provides a more comprehensive understanding of how socioeconomic and political factors collectively influence voting patterns.
3. Model Comparison:
   - We evaluate the models using performance metrics such as SSE, SSR, R-squared, and adjusted R-squared. This helps determine which model best explains the variability in the election outcomes.

Why Choose Logistic Regression?
1. Suitability for Binary Outcomes: Logistic regression is tailored explicitly for binary response variables like `ObamaWin`.
2. Probabilistic Interpretation: The model outputs probabilities, allowing us to estimate the likelihood of Obama winning in each state.
3. Flexibility with Predictors: Logistic regression can handle a mix of numerical predictors (e.g., `Income`, `Dem.Rep`) and their potential interactions.
4. Diagnostic Tools: Logistic regression provides tools to assess model fit, assumptions, and variable importance, ensuring robust and interpretable results.

This methodological approach is comprehensive yet efficient, ensuring that our findings are both statistically valid and practically relevant for understanding the factors influencing the 2008 election outcomes.

# Dataset Overview
1. Description of the Dataset:
The **Election08** dataset provides state-by-state information related to the 2008 U.S. presidential election. It includes seven variables, capturing key socioeconomic, educational, and political characteristics of each state alongside the election outcome. These variables enable an in-depth analysis of the factors contributing to Barack Obama's or John McCain's victories in individual states.

2. Data Variable Dictionary:
- State: Name of the state.
- Abr: Abbreviation for the state.
- Income: Per capita income in the state as of 2007 (in US dollars).
- HS: Percentage of adults with at least a high school education.
- BA: Percentage of adults with at least a college education.
- Dem.Rep: Difference in percent Democrat and percent Republican (based on a 2008 Gallup survey).
- ObamaWin: 
  - `1`: Obama (Democrat) won the state in 2008.
  - `0`: McCain (Republican) won the state in 2008.

# Dataframe Details
1. Observations: 51 (50 states plus the District of Columbia).
2. Variables: 7 (6 predictors and 1 dependent variable).

# Data Sources:
1. Income Data: U.S. Census Bureau, Table 659. Personal Income Per Capita (2007).
2. High School Education Data: U.S. Census Bureau, 1990 Census of Population, [NCES Digest (http://nces.ed.gov/programs/digest/d08/tables/dt08_011.asp).
3. College Education Data: U.S. Census Bureau, Table 225. Educational Attainment by State (2007).
4. Political Leaning Data: Gallup, [State of the States: Political Party Affiliation](http://www.gallup.com/poll/114016/state-states-political-party-affiliation.aspx#1).

# Data Collection Procedure
The dataset was compiled by merging information from the sources listed above, ensuring consistency in definitions and measurements across variables. Each variable was carefully checked to match its description in the dataset's metadata, and all data represent the state-level characteristics leading up to the 2008 election. This comprehensive and systematic approach ensures the dataset is suitable for logistic regression analysis, allowing for robust predictions of the 2008 U.S. presidential election results.

This study provides a structured approach to understanding how state-level characteristics influenced the 2008 presidential election and offers insights into broader patterns of electoral behavior in the United States.

# Data Summary
```{r}
summary(Election08)
```

# Visualization of Relationships Between Variables
```{r}
create_boxplot <- function(data, predictor, response, title, x_label) {
  ggplot(data, aes(x = !!sym(predictor), y = factor(!!sym(response)), fill = factor(!!sym(response)))) +
    geom_boxplot() +
    labs(title = title, x = x_label, y = "Obama Win (1=Yes, 0=No)") +
    scale_fill_manual(values = c("red", "blue")) +
    theme_minimal()
}
create_boxplot(Election08, "Income", "ObamaWin", "Income vs ObamaWin", "Income")
create_boxplot(Election08, "HS", "ObamaWin", "High School Education (%) vs ObamaWin", "HS (%)")
create_boxplot(Election08, "BA", "ObamaWin", "Bachelor's Degree (%) vs ObamaWin", "BA (%)")
create_boxplot(Election08, "Dem.Rep", "ObamaWin", "Democrat-Republican Difference vs ObamaWin", "Dem.Rep (%)")
```

# Statistical Analysis

# Check Conditions
The conditions for logistic regressions are linearity, randomness, and independence.
Linearity: This means that a linear relationship between the log(odds) and the predictor should exist.
The process of data collection is assumed to be random, and each observation is assumed to be independent.

```{r}
empirical_logit_plot_simple <- function(data, predictor, response) {
  data$BinnedPredictor <- cut(data[[predictor]], breaks = 10)

  summary_data <- aggregate(data[[response]], by = list(Bin = data$BinnedPredictor), FUN = sum)
  summary_data$Total <- aggregate(data[[response]], by = list(Bin = data$BinnedPredictor), FUN = length)$x
  summary_data$MeanPredictor <- aggregate(data[[predictor]], by = list(Bin = data$BinnedPredictor), FUN = mean)$x
  summary_data$ProportionSuccess <- summary_data$x / summary_data$Total
  summary_data$OddsSuccess <- summary_data$ProportionSuccess / (1 - summary_data$ProportionSuccess)
  summary_data$EmpiricalLogit <- log(summary_data$OddsSuccess)
  summary_data <- summary_data[is.finite(summary_data$EmpiricalLogit), ]

  ggplot(summary_data, aes(x = MeanPredictor, y = EmpiricalLogit)) +
    geom_point() +
    geom_smooth(method = "loess", se = FALSE, color = "blue") +
    labs(
      title = paste("Empirical Logit Plot for", predictor),
      x = predictor,
      y = "Empirical Logit"
    ) +
    theme_minimal()
}

empirical_logit_plot_simple(Election08, "Income", "ObamaWin")
empirical_logit_plot_simple(Election08, "HS", "ObamaWin")
empirical_logit_plot_simple(Election08, "BA", "ObamaWin")
empirical_logit_plot_simple(Election08, "Dem.Rep", "ObamaWin")
```

Thus, the linearity condition is satisfied since a linear relationship exists between the log(odds) and the predictor(s).

```{r}
# Correlation matrix
cor_matrix <- cor(Election08[, c("Income", "HS", "BA", "Dem.Rep")])
print(cor_matrix)
```

```{r}
# Variance Inflation Factor (VIF)
vif(lm(Dem.Rep ~ Income + HS + BA, data = Election08))
```

# Simple Logistic Regression Model Construction
```{r}
models <- list(
  Income = glm(ObamaWin ~ Income, data = Election08, family = "binomial"),
  HS = glm(ObamaWin ~ HS, data = Election08, family = "binomial"),
  BA = glm(ObamaWin ~ BA, data = Election08, family = "binomial"),
  DemRep = glm(ObamaWin ~ Dem.Rep, data = Election08, family = "binomial")
)
```
# Summary of the Simple Logistic Regression Models
```{r}
lapply(models, summary)
```

# Multiple Logistic Regression Model Construction
```{r}
final_model <- glm(ObamaWin ~ Income + HS + BA + Dem.Rep, data = Election08, family = "binomial")
```

# Summary of the Multiple Logistic Regression Models
```{r}
summary(final_model)
```

# Model Comparison by G-tests
```{r}
## G-test for Income
G <- 69.737 - 48.867
df <- 1
p_value_g_test <- pchisq(G, df, lower.tail = FALSE)
print(p_value_g_test)

## G-test for HS
G <- 69.737 - 65.741
df <- 1
p_value_g_test <- pchisq(G, df, lower.tail = FALSE)
print(p_value_g_test)

## G-test for BA
G <- 69.737 - 49.689
df <- 1
p_value_g_test <- pchisq(G, df, lower.tail = FALSE)
print(p_value_g_test)

## G-test for DemRep
G <- 69.737 - 27.167
df <- 1
p_value_g_test <- pchisq(G, df, lower.tail = FALSE)
print(p_value_g_test)

## G-test for Final Model
G <- 69.737 - 9.7252
df <- 4
p_value_g_test <- pchisq(G, df, lower.tail = FALSE)
print(p_value_g_test)
```

# Results & Interpretation

# Suggestions for Future Research
1. Inclusion of Additional Variables: Future studies could incorporate other influential factors such as voter turnout rates, urban versus rural demographics, or historical voting patterns to gain a more comprehensive understanding of election outcomes.
2. Temporal Expansion: Analyzing data from other presidential elections could help validate whether `Dem.Rep` remains the most influential predictor across different election years.
3. Regional Analysis: Conducting regional studies (e.g., Midwest vs. South) could provide insights into whether the influence of political leaning varies geographically.
4. Interaction Effects: Future research could explore interactions between predictors, such as how income levels might moderate the effect of education on election outcomes.

# Limitations
1. Restricted Dataset: The analysis is based on a single election year (2008), limiting the generalizability of findings to other elections.
2. Simplistic Model Assumptions: The logistic regression models assume linear relationships between predictors and the log odds of winning, which may oversimplify complex voter behaviors.
3. Data Availability: Some variables, like detailed demographic breakdowns, were unavailable and could provide a richer analysis.
4. Binary Outcome: The analysis simplifies the election outcome to a binary variable, ignoring nuances such as the margin of victory.

# Implications
1. Political Strategy: The strong influence of `Dem.Rep` highlights the importance of targeted campaigning in states with close Democrat-Republican margins. Understanding political leanings at the state level can guide resource allocation and strategy.
2. Policy Prioritization: Socioeconomic factors like income and education, while secondary, still contribute to election outcomes. Policymakers may consider how addressing these issues aligns with voter preferences.
3. Model Application: The multiple logistic regression model's effectiveness suggests its utility for other binary prediction tasks, such as forecasting election results or voter turnout based on demographic factors.

# Conclusion
This study identifies `Dem.Rep`, the difference between the percentage of Democrats and Republicans in a state, as the most influential factor in predicting the 2008 U.S. presidential election outcome. While socioeconomic variables such as income and education levels play a role, their effects are secondary to political leaning. Moreover, the multiple logistic regression model proves to be the most effective for predicting election outcomes, as it accounts for the combined influence of all predictors. These findings underscore the importance of political alignment and multivariable approaches in understanding electoral behavior, providing valuable insights for future analyses and campaign strategies.
